# Practica 2.1: Introducción a la programación de sistemas UNIX

# Objetivos
En esta práctica estudiaremos el uso básico del API de un sistema UNIX y su entorno de desarrollo. En particular, se usarán funciones para gestionar errores y obtener información.

# Gestión de errores
Usar las funciones disponibles en el API del sistema (perror(3) y strerror(3)) para gestionar los errores en los siguientes casos. En cada ejercicio, añadir las librerías necesarias (#include).

```c
#include <sys/types.h>
#include <unistd.h>
#include <stdio.h>
```

### Ejercicio 1
Añadir el código necesario para gestionar correctamente los errores generados por la llamada a setuid(2). Consultar en el manual el propósito de la llamada y su prototipo.
```c
int main() {
	setuid(0);
	return 1;
}
```

### Ejercicio 2 
Imprimir el código de error generado por la llamada del código anterior, tanto en su versión numérica como la cadena asociada.

### Ejercicio 3

Escribir un programa que imprima todos los mensajes de error disponibles en el sistema. Considerar inicialmente que el límite de errores posibles es 255.

# Información del sistema

### Ejercicio 4
El comando del sistema uname(1) muestra información sobre diversos aspectos del sistema. Consultar la página de manual y obtener la información del sistema.

### Ejercicio 5
Escribir un programa que muestre, con uname(2), cada aspecto del sistema y su valor. Comprobar la correcta ejecución de la llamada en cada caso.
### Ejercicio 6[Router]
Activar el reenvío de paquetes (_forwarding_) en Router para que efectivamente pueda funcionar como encaminador entre las redes 10.0.0.0/24 y 192.168.0.0/24. Ejecutar el siguiente comando:
### Ejercicio 7[VM1, VM4]
Añadir la máquina Router como encaminador por defecto para VM1 y VM2. Usar el comando ip route.
### Ejercicio 8[VM4]
Aunque la configuración adecuada para la tabla de rutas de hosts en redes como las consideradas en esta práctica consiste en añadir una ruta por defecto, es posible incluir rutas para redes concretas. Añadir a la tabla de rutas de VM4 una ruta a la red 10.0.0.0/24 via Router.

### Ejercicio 9[VM1, VM4]
Usar la orden ping entre las máquinas VM1 y VM4. Con ayuda de la herramienta wireshark completar la siguiente tabla para todos los paquetes intercambiados hasta la recepción de la primera respuesta Echo Reply.

#### Red 10.0.0.0/24 - VM1
| MAC Origen | MAC Desitno | Protocolo | IP Origen | IP Destino | Tipo Mensaje |
|--|--|--|--|--|--|--|--|
|  |  |  |  |  |  |  |  | 

#### Red 192.168.0.0/24 - VM4
| MAC Origen | MAC Desitno | Protocolo | IP Origen | IP Destino | Tipo Mensaje |
|--|--|--|--|--|--|--|--|
|  |  |  |  |  |  |  |  | 

# Configuración dinámica de hosts
El protocolo DHCP permite configurar dinámicamente los parámetros de red un host. En esta sección configuraremos Router como servidor DHCP para las dos redes. Aunque DHCP puede incluir muchos parámetros de configuración, en esta práctica sólo fijaremos el encaminador por defecto.

### Ejercicio 10[VM1, VM2, VM4]
Eliminar las direcciones IP de los interfaces (ip addr del).
### Ejercicio 11[Router]
Configurar el servidor DHCP para las dos redes:
- Editar el fichero /etc/dhcp/dhcpd.conf y añadir dos secciones subnet para cada red que definan los rangos de direcciones_,_ 10.0.0.50 - 10.0.0.100 y 192.168.0.50 - 192.168.0.100, respectivamente. Además, incluir la opción routers con la IP de Router en cada red.
- Arrancar el servicio con el comando ``` service dhcpd start ```
### Ejercicio 12[Router, VM4]
Iniciar la captura de paquetes en Router. Arrancar el cliente DHCP ``` dhclient -d eth0 ``` en la máquina virtual VM1 y observar el proceso de configuración. Completar la siguiente tabla:

| IP Origen | IP Destino | Mensaje DHCP | Opciones DHCP |
|--|--|--|--|
|  |  |  |  |
### Ejercicio 13 [VM4]
Durante el arranque del sistema se pueden configurar automáticamente determinados interfaces según la información almacenada en el disco del servidor. Consultar el fichero /etc/sysconfig/network-scripts/ifcfg-eth0 de VM4, que configura automáticamente eth0 usando DHCP. Para más información, consultar el fichero /usr/share/doc/initscripts-*/sysconfig.txt.
### Ejercicio 14 [VM4]
Comprobar la configuración automática con las órdenes ifup e ifdown. Verificar la conectividad entre todas las máquinas de las dos redes.



> Written with [StackEdit](https://stackedit.io/).
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTY0NTY4NTY0XX0=
-->